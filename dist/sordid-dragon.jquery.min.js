// jQuery the Sordid Dragon
// Copyright Poll Everywhere
// Paul Cortens & Mike Foley
// https://github.com/polleverywhere/sordid-dragon
// Version 1.2.0

!function(r){return r.fn.sordidDragon=function(n,o){var t,e,i,d,a,s,u,c,l,f,g,h;return null==n&&(n="enable"),null==o&&(o={}),"string"!=typeof n&&(o=n),e=this,i=void 0,h=function(r){return r.css({opacity:0}),i.is(":visible")||(i.addClass("sordidDragon-placeholder"),r.after(i),i.css({opacity:.5})),r.hide(),r.css({opacity:1})},u=function(r){return i.is(":visible")?(i.after(r),i.remove(),r.show()):void 0},t=null,g=function(r){return t.is(":visible")||(t.addClass("sordidDragon-ghost"),t.css({position:"fixed",opacity:1}),e.append(t)),t.css({left:i.offset().left,top:r-i.outerHeight()/2-window.scrollY,width:i.outerWidth()-window.scrollX})},s=function(){return t.remove()},f=null,d=function(){return f=[],e.children(o.childSelector).each(function(n,o){var t;return t=r(o),f.push([t.offset().top,t.offset().top+t.outerHeight()])}),f},a=function(r){var n,o,t;for(n=o=0,t=f.length;t>=0?t>o:o>t;n=t>=0?++o:--o)if(r>=f[n][0]&&r<f[n][1])return n;return null},l=function(r){var n,t,d;return n=e.children(""+(o.childSelector||"")+":visible"),t=n.index(r),d=n.index(i),t>d?r.after(i):d>t?r.before(i):void 0},c=function(r){return/touch/.test(r.type)},e.children(o.childSelector).each(function(f,v){var D,p;return D=r(v),p=o.handle?D.find(o.handle):D,p.attr("draggable",String("destroy"!==n)),p.off("selectstart.sordidDragon touchstart.sordidDragon dragstart.sordidDragon touchmove.sordidDragon drag.sordidDragon touchend.sordidDragon dragend.sordidDragon"),D.off("dragenter.sordidDragon"),"destroy"!==n?(p.on("selectstart.sordidDragon",function(r){return r.target.dragDrop()}),p.on("touchstart.sordidDragon dragstart.sordidDragon",function(r){var n;return c(r)&&(d(),t=D.clone(),r.preventDefault()),null!=(n=r.originalEvent.dataTransfer)&&n.setData("text",""),i=D.clone()}),p.on("touchmove.sordidDragon drag.sordidDragon",function(r){var n,o;return h(D),c(r)?(o=r.originalEvent.targetTouches[0].pageY,g(o),n=a(o),null!=n&&l(e.children(":visible").eq(n)),r.preventDefault()):void 0}),D.on("dragenter.sordidDragon",function(){return l(D)}),p.on("touchend.sordidDragon dragend.sordidDragon",function(r){return u(D),c(r)?(s(),d(),r.preventDefault()):void 0})):void 0})}}(jQuery);